import{_ as q,s as re,t as ne,G as ie,c as R,j as t,a as i,F as a,u as oe,b as _}from"./react-app-7fdce188.js";import{i as f,m as de,b as B,r as o,v as le,w as ce,e as he,G as me,c as d,J as ue,U as xe,H as be,C as we,x as W,o as h,h as V}from"./vendor-9741ff7b.js";import"./lodash-0223fb8a.js";import"./bignumber-63705fc6.js";const U=f.lazy(()=>q(()=>import("./BuySpace-66862a7a.js"),["assets/BuySpace-66862a7a.js","assets/react-app-7fdce188.js","assets/vendor-9741ff7b.js","assets/bignumber-63705fc6.js","assets/lodash-0223fb8a.js"])),pe=f.lazy(()=>q(()=>import("./SpaceEdit-ac2e0c3e.js"),["assets/SpaceEdit-ac2e0c3e.js","assets/react-app-7fdce188.js","assets/vendor-9741ff7b.js","assets/bignumber-63705fc6.js","assets/lodash-0223fb8a.js"])),ke=({name:b="",language:n,html:w,format:E,sidebar:l,info:F,session:ye})=>{const s=de(),[p,ve]=B(re),[e,G]=o.useState(F),[L,u]=o.useState(!1),[y,S]=o.useState(!1),[X,$]=o.useState(!0),[g]=B(ne),C=(g==null?void 0:g[b])||"",[M,k]=o.useState(""),[N,A]=o.useState(null);o.useEffect(()=>{k(w||"")},[w]);const Y=async()=>{console.log(await(async()=>{await V({transactions:[{value:"0",data:"withdraw",receiver:_,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Au intrat banutii":"Money is in your wallet",transactionDuration:1e4}})})())},{successfulTransactionsArray:z}=le(),{pendingTransactionsArray:O}=ce(),J=r=>{if(!r[1].transactions)return!1;const m=h.Transaction.fromPlainObject(r[1].transactions[0]);if(m.getReceiver().bech32()===_){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===2&&c[0]==="resetSpace"&&c[1]===new h.ArgSerializer().valuesToString([new h.StringValue(e.name)]).argumentsString)return!0}return!1},K=r=>{if(!r[1].transactions)return!1;const m=h.Transaction.fromPlainObject(r[1].transactions[0]);if(m.getReceiver().bech32()===_){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===1&&c[0]==="withdraw")return!0}return!1},j=o.useMemo(()=>z.some(J),[z]),P=o.useMemo(()=>O.some(K),[O]);o.useEffect(()=>{j&&D(e.name)},[j]);const Q=async r=>{if(!r||r.length===0)return;console.log(await(async()=>{const v=new h.ArgSerializer;let c="resetSpace";c+="@"+v.valuesToString([new h.StringValue(r)]).argumentsString,await V({transactions:[{value:"0",data:c,receiver:_,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Spatiul a fost resetat":"Space was reset",transactionDuration:1e4}})})())},D=async r=>{const v=(await ie.request(he.gql`
            query adSpaceInfo($spaceName: String!, $initial: Boolean) {
                adSpaceInfo(spaceName: $spaceName, initial: $initial) {
                    name
                    is_new
                    owner
                    paid_amount
                    paid_until
                }
            }
        `,{spaceName:r,initial:X})).adSpaceInfo;G(v)};o.useEffect(()=>{(async()=>e!=null&&e.name||(await D(b),$(!0)))()},[b]);const T=o.useCallback(()=>{D(b)},[b]),Z=[(s==null?void 0:s.address)==R&&t("div",{style:{flexBasis:"100%",height:0}},"emtpty-div"),(s==null?void 0:s.address)==R&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),Y()},children:[!P&&i(a,{children:[n=="en"&&t(a,{children:"Withdraw"}),n=="ro"&&t(a,{children:"Retrage banii"})]}),P&&t(a,{children:"..."})]},"withdraw-btn"),s.address&&s.address==R&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-red-500 text-white shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),Q((e==null?void 0:e.name)||"")},children:[n=="en"&&t(a,{children:"Reset space"}),n=="ro"&&t(a,{children:"Reseteaza spatiul"})]},"reset-btn")],H=[s.address&&s.address!=(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),u(!0)},children:[n=="en"&&t(a,{children:"Replace with your advertisement"}),n=="ro"&&t(a,{children:"Inlocuieste cu reclama ta"})]},"replace-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&!y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),S(!0)},children:[n=="en"&&t(a,{children:"Edit space"}),n=="ro"&&t(a,{children:"Editeaza spatiul"})]},"edit-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),S(!1)},children:[n=="en"&&t(a,{children:"Cancel edit"}),n=="ro"&&t(a,{children:"Anuleaza editarea"})]},"cancel-btn"),i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),me()},children:[n=="en"&&t(a,{children:"Logout"}),n=="ro"&&t(a,{children:"Logout"})]},"logout-btn"),...Z].filter(Boolean),{showLogin:x,setShowLogin:I,loginActions:ee}=oe({sessionId:p});o.useEffect(()=>{s!=null&&s.address&&x&&A(null)},[x,s]),o.useEffect(()=>{s!=null&&s.address&&N&&N=="outbid"&&(e.owner&&e.owner!=s.address&&u(!0),A(null))},[N,s==null?void 0:s.address,e]);const te=[!(e!=null&&e.is_new)&&i("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__m-1 text-xs p-2 mx-0 bg-yellow-500 shadow-box hover:shadow-boxhvr text-black",onClick:r=>{r.preventDefault(),s!=null&&s.address?u(!0):(I(!x),A(x?null:"outbid"))},children:[x&&i(a,{children:[n=="en"&&t(a,{children:"Cancel outbid"}),n=="ro"&&t(a,{children:"Renunta"})]}),!x&&i(a,{children:[n=="en"&&t(a,{children:"Replace with your advertisement"}),n=="ro"&&t(a,{children:"Inlocuieste cu reclama ta"})]})]},"login-btn"),...ee].filter(Boolean);if(!(e!=null&&e.name)&&w&&w.length>1)return t(a,{children:t("div",{className:d("bg-primary py-4 px-4",{}),children:e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?C:M}})})});if(e!=null&&e.is_new)return t("div",{className:d("py-4 px-4",{"bg-primary":E=="light","bg-splash text-white":E=="dark"}),children:i("div",{className:"flex flex-col items-center justify-center",children:[(!s.address||s.address&&e.owner!=s.address)&&i(a,{children:[n=="ro"&&i(a,{children:[t("div",{className:d("font-bold text-center",{"text-2xl":!l,"mb-4":l}),children:"Acest spatiu publicitar poate fi tau pentru 10 de zile."}),i("p",{className:d("text-center",{"mb-4":l}),children:["Costa doar ",e==null?void 0:e.paid_amount," USDC/USDT / 10 zile.",t("br",{}),"Il inchiriezi instant cu ajutorul blockchain-ului MultiversX si il poti personaliza cum vrei tu."]})]}),n=="en"&&i(a,{children:[t("div",{className:d("font-bold",{"text-2xl":!l,"mb-4":l}),children:"This ad space can be yours for 10 days."}),i("p",{className:d("text-center",{"mb-4":l}),children:["It costs only ",e==null?void 0:e.paid_amount," USDC/USDT per 10 days.",t("br",{})," You rent it instantly using the MultiversX blockchain and you can customize it as you want."]})]})]}),!s.address&&t(a,{children:i("div",{className:d("flex mt-2 flex-col items-center md:flex-row",{"flex flex-col md:flex-col gap-2":l}),children:[t(ue,{isWalletConnectV2:!0,token:p,logoutRoute:window.location.href,className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",showScamPhishingAlert:!0}),t(xe,{token:p,showScamPhishingAlert:!0,className:"text-xs p-2 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black  border-secondary"}),t(be,{className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",token:p,loginButtonText:"MultiversX DeFi Wallet"}),t(we,{token:p,callbackRoute:window.location.pathname,className:"text-xs p-2 mx-0 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",onLoginRedirect:{callbackRoute:window.location.pathname},nativeAuth:!0})]})}),s.address&&e.owner!=s.address&&t(a,{children:t("div",{className:d("mt-2",{"mt-4":l}),children:i("button",{className:"p-2 bg-secondary text-black shadow-box hover:shadow-boxhvr text-xs",onClick:r=>{r.preventDefault(),u(!0)},children:[n=="ro"&&t(a,{children:"Inchiriaza acest spatiu"}),n=="en"&&t(a,{children:"Rent this space"})]})})}),s.address&&t(a,{children:t("div",{className:d("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":l}),style:{width:"fit-content"},children:H})}),t(f.Suspense,{fallback:t("div",{}),children:t(U,{open:L,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})});const se=e!=null&&e.paid_until?W(new Date((e==null?void 0:e.paid_until)*1e3),"dd.MM.yyyy HH:mm"):"",ae=e!=null&&e.paid_until?W(new Date((e==null?void 0:e.paid_until)*1e3),"MM-dd-yyyy HH:mm a"):"";return i(a,{children:[i("div",{className:d("bg-primary py-4 px-4",{}),children:[(s==null?void 0:s.address)&&(e==null?void 0:e.owner)==s.address&&t(a,{children:i("div",{className:d("font-bold text-xs bg-secondary py-2 px-4 rounded-2xl max-w border border-black mb-2"),style:{maxWidth:"fit-content"},children:[n=="ro"&&i(a,{children:["Deti acest spatiu pana in ",se]}),n=="en"&&i(a,{children:["You own this space until ",ae]})]})}),e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?C:M}}),y&&t(a,{children:t(o.Suspense,{fallback:t("div",{children:"Loading"}),children:t(pe,{spaceInfo:e,close:()=>{S(!1)},sidebar:l,language:n,refreshSpace:r=>{T(),k(r)}})})}),e.name&&i(a,{children:[s.address&&t("div",{className:d("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":l}),style:{width:"fit-content"},children:H}),!(s!=null&&s.address)&&t("div",{className:d("mt-3 self-end flex gap-2 justify-end",{"flex-col mt-4":l}),children:te})]})]}),t(f.Suspense,{fallback:t("div",{}),children:t(U,{open:L,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})};export{ke as default};
