import{s as re,t as ae,G as ne,c as M,j as t,a as i,F as r,u as ie,b as f}from"./react-app-29673c85.js";import{f as S,p as oe,b as W,r as o,s as de,t as le,d as ce,Z as he,c as d,F as me,q as ue,Y as xe,v as be,u as P,o as h,k as q}from"./vendor-ec6d72e2.js";import"./bignumber-c60c4193.js";import"./lodash-42dc8045.js";const F=S.lazy(()=>import("./BuySpace-28a92702.js")),we=S.lazy(()=>import("./SpaceEdit-c5751d6c.js")),ge=({name:b="",language:n,html:w,format:R,sidebar:l,info:U,session:pe})=>{const s=oe(),[p,ye]=W(re),[e,$]=o.useState(U),[E,u]=o.useState(!1),[y,_]=o.useState(!1),[V,X]=o.useState(!0),[g]=W(ae),L=(g==null?void 0:g[b])||"",[C,k]=o.useState(""),[N,A]=o.useState(null);o.useEffect(()=>{k(w||"")},[w]);const Y=async()=>{console.log(await(async()=>{await q({transactions:[{value:"0",data:"withdraw",receiver:f,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Au intrat banutii":"Money is in your wallet",transactionDuration:1e4}})})())},{successfulTransactionsArray:z}=de(),{pendingTransactionsArray:j}=le(),G=a=>{if(!a[1].transactions)return!1;const m=h.Transaction.fromPlainObject(a[1].transactions[0]);if(m.getReceiver().bech32()===f){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===2&&c[0]==="resetSpace"&&c[1]===new h.ArgSerializer().valuesToString([new h.StringValue(e.name)]).argumentsString)return!0}return!1},Z=a=>{if(!a[1].transactions)return!1;const m=h.Transaction.fromPlainObject(a[1].transactions[0]);if(m.getReceiver().bech32()===f){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===1&&c[0]==="withdraw")return!0}return!1},O=o.useMemo(()=>z.some(G),[z]),B=o.useMemo(()=>j.some(Z),[j]);o.useEffect(()=>{O&&D(e.name)},[O]);const J=async a=>{if(!a||a.length===0)return;console.log(await(async()=>{const v=new h.ArgSerializer;let c="resetSpace";c+="@"+v.valuesToString([new h.StringValue(a)]).argumentsString,await q({transactions:[{value:"0",data:c,receiver:f,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Spatiul a fost resetat":"Space was reset",transactionDuration:1e4}})})())},D=async a=>{const v=(await ne.request(ce.gql`
            query adSpaceInfo($spaceName: String!, $initial: Boolean) {
                adSpaceInfo(spaceName: $spaceName, initial: $initial) {
                    name
                    is_new
                    owner
                    paid_amount
                    paid_until
                }
            }
        `,{spaceName:a,initial:V})).adSpaceInfo;$(v)};o.useEffect(()=>{(async()=>e!=null&&e.name||(await D(b),X(!0)))()},[b]);const T=o.useCallback(()=>{D(b)},[b]),K=[(s==null?void 0:s.address)==M&&t("div",{style:{flexBasis:"100%",height:0}},"emtpty-div"),(s==null?void 0:s.address)==M&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),Y()},children:[!B&&i(r,{children:[n=="en"&&t(r,{children:"Withdraw"}),n=="ro"&&t(r,{children:"Retrage banii"})]}),B&&t(r,{children:"..."})]},"withdraw-btn"),s.address&&s.address==M&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-red-500 text-white shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),J((e==null?void 0:e.name)||"")},children:[n=="en"&&t(r,{children:"Reset space"}),n=="ro"&&t(r,{children:"Reseteaza spatiul"})]},"reset-btn")],H=[s.address&&s.address!=(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),u(!0)},children:[n=="en"&&t(r,{children:"Replace with your advertisement"}),n=="ro"&&t(r,{children:"Inlocuieste cu reclama ta"})]},"replace-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&!y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),_(!0)},children:[n=="en"&&t(r,{children:"Edit space"}),n=="ro"&&t(r,{children:"Editeaza spatiul"})]},"edit-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),_(!1)},children:[n=="en"&&t(r,{children:"Cancel edit"}),n=="ro"&&t(r,{children:"Anuleaza editarea"})]},"cancel-btn"),i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),he()},children:[n=="en"&&t(r,{children:"Logout"}),n=="ro"&&t(r,{children:"Logout"})]},"logout-btn"),...K].filter(Boolean),{showLogin:x,setShowLogin:Q,loginActions:I}=ie({sessionId:p});o.useEffect(()=>{s!=null&&s.address&&x&&A(null)},[x,s]),o.useEffect(()=>{s!=null&&s.address&&N&&N=="outbid"&&(e.owner&&e.owner!=s.address&&u(!0),A(null))},[N,s==null?void 0:s.address,e]);const ee=[!(e!=null&&e.is_new)&&i("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__m-1 text-xs p-2 mx-0 bg-yellow-500 shadow-box hover:shadow-boxhvr text-black",onClick:a=>{a.preventDefault(),s!=null&&s.address?u(!0):(Q(!x),A(x?null:"outbid"))},children:[x&&i(r,{children:[n=="en"&&t(r,{children:"Cancel outbid"}),n=="ro"&&t(r,{children:"Renunta"})]}),!x&&i(r,{children:[n=="en"&&t(r,{children:"Replace with your advertisement"}),n=="ro"&&t(r,{children:"Inlocuieste cu reclama ta"})]})]},"login-btn"),...I].filter(Boolean);if(!(e!=null&&e.name)&&w&&w.length>1)return t(r,{children:t("div",{className:d("bg-primary py-4 px-4",{}),children:e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?L:C}})})});if(e!=null&&e.is_new)return t("div",{className:d("py-4 px-4",{"bg-primary":R=="light","bg-splash text-white":R=="dark"}),children:i("div",{className:"flex flex-col items-center justify-center",children:[(!s.address||s.address&&e.owner!=s.address)&&i(r,{children:[n=="ro"&&i(r,{children:[t("div",{className:d("font-bold text-center",{"text-2xl":!l,"mb-4":l}),children:"Acest spatiu publicitar poate fi tau pentru 10 de zile."}),i("p",{className:d("text-center",{"mb-4":l}),children:["Costa doar ",e==null?void 0:e.paid_amount," USDC/USDT / 10 zile.",t("br",{}),"Il inchiriezi instant cu ajutorul blockchain-ului MultiversX si il poti personaliza cum vrei tu."]})]}),n=="en"&&i(r,{children:[t("div",{className:d("font-bold",{"text-2xl":!l,"mb-4":l}),children:"This ad space can be yours for 10 days."}),i("p",{className:d("text-center",{"mb-4":l}),children:["It costs only ",e==null?void 0:e.paid_amount," USDC/USDT per 10 days.",t("br",{})," You rent it instantly using the MultiversX blockchain and you can customize it as you want."]})]})]}),!s.address&&t(r,{children:i("div",{className:d("flex mt-2 flex-col items-center md:flex-row",{"flex flex-col md:flex-col gap-2":l}),children:[t(me,{nativeAuth:!0,token:p,logoutRoute:window.location.href,className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary"}),t(ue,{token:p,showScamPhishingAlert:!0,className:"text-xs p-2 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black  border-secondary"}),t(xe,{className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",token:p,loginButtonText:"MultiversX DeFi Wallet"}),t(be,{token:p,callbackRoute:window.location.pathname,className:"text-xs p-2 mx-0 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary"})]})}),s.address&&e.owner!=s.address&&t(r,{children:t("div",{className:d("mt-2",{"mt-4":l}),children:i("button",{className:"p-2 bg-secondary text-black shadow-box hover:shadow-boxhvr text-xs",onClick:a=>{a.preventDefault(),u(!0)},children:[n=="ro"&&t(r,{children:"Inchiriaza acest spatiu"}),n=="en"&&t(r,{children:"Rent this space"})]})})}),s.address&&t(r,{children:t("div",{className:d("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":l}),style:{width:"fit-content"},children:H})}),t(S.Suspense,{fallback:t("div",{}),children:t(F,{open:E,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})});const te=e!=null&&e.paid_until?P(new Date((e==null?void 0:e.paid_until)*1e3),"dd.MM.yyyy HH:mm"):"",se=e!=null&&e.paid_until?P(new Date((e==null?void 0:e.paid_until)*1e3),"MM-dd-yyyy HH:mm a"):"";return i(r,{children:[i("div",{className:d("bg-primary py-4 px-4",{}),children:[(s==null?void 0:s.address)&&(e==null?void 0:e.owner)==s.address&&t(r,{children:i("div",{className:d("font-bold text-xs bg-secondary py-2 px-4 rounded-2xl max-w border border-black mb-2"),style:{maxWidth:"fit-content"},children:[n=="ro"&&i(r,{children:["Deti acest spatiu pana in ",te]}),n=="en"&&i(r,{children:["You own this space until ",se]})]})}),e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?L:C}}),y&&t(r,{children:t(o.Suspense,{fallback:t("div",{children:"Loading"}),children:t(we,{spaceInfo:e,close:()=>{_(!1)},sidebar:l,language:n,refreshSpace:a=>{T(),k(a)}})})}),e.name&&i(r,{children:[s.address&&t("div",{className:d("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":l}),style:{width:"fit-content"},children:H}),!(s!=null&&s.address)&&t("div",{className:d("mt-3 self-end flex gap-2 justify-end",{"flex-col mt-4":l}),children:ee})]})]}),t(S.Suspense,{fallback:t("div",{}),children:t(F,{open:E,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})};export{ge as default};
