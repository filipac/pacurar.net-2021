import{j as k,R as A,b as E,G as S,r as $,c as m,d as p,e as T,g as I,f as R,h as _,m as x,i as C,o as q,k as b,l as j,J as v,I as H,n as N,p as P,H as B,q as G}from"./vendor-4baf7309.js";import"./lodash-87d1c6bb.js";import"./bignumber-d824444f.js";const ee=k.Fragment,d=k.jsx,L=k.jsxs,z="modulepreload",D=function(a){return"/wp-content/themes/pacurar2020/public/"+a},y={},O=function(r,e,t){if(!e||e.length===0)return r();const f=document.getElementsByTagName("link");return Promise.all(e.map(n=>{if(n=D(n),n in y)return;y[n]=!0;const l=n.endsWith(".css"),i=l?'[rel="stylesheet"]':"";if(!!t)for(let u=f.length-1;u>=0;u--){const c=f[u];if(c.href===n&&(!l||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=l?"stylesheet":z,l||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),l)return new Promise((u,c)=>{s.addEventListener("load",u),s.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>r())},W="mainnet",F="6849db0c57e4bf778ed8bdd2d721ee4f",te="erd1qqqqqqqqqqqqqpgqq72p4p73sx6wkurl3epefzt4dkvwh7frvp3s73l9k6",se="erd158lk5s2m3cpjyg5fwgm0pwnt8ugnc29mj4nafkrvcrhfdfpgvp3swpmnrj",M=A.lazy(()=>O(()=>import("./MainAdSpaceApp-35da54a1.js"),["assets/MainAdSpaceApp-35da54a1.js","assets/vendor-4baf7309.js","assets/bignumber-d824444f.js","assets/lodash-87d1c6bb.js"])),J=({children:a,allAds:r})=>d(E,{children:L(S,{environment:W,customNetworkConfig:{walletConnectV2ProjectId:F},dappConfig:{logoutRoute:window.location.href},children:[a,r.map(e=>{const t=e.innerHTML;return e.innerHTML="",$.createPortal(d(m.Suspense,{fallback:d("div",{}),children:d(M,{name:e.dataset.spaceName,language:e.dataset.language,format:e.dataset.format,sidebar:e.dataset.sidebar==1,info:e.dataset.initialInfo?JSON.parse(e.dataset.initialInfo):{},session:e.dataset.sessionId,html:t})}),e)})]})}),g=new p.GraphQLClient("/gql");g.setHeader("X-Requested-With","XMLHttpRequest");const U=T({key:"session",default:""}),ne=T({key:"tempAd",default:{_title:""}}),V=()=>{var l;const a=I(),r=R(),e=_(),t=x(),[f,n]=C(U);return m.useEffect(()=>{let i=document.querySelector("[data-web3-space]");if(i){n(i.dataset.sessionId);return}g.request(p.gql`
            { sessionInfo { id } }
        `).then(o=>{n(o.sessionInfo.id)})},[]),m.useEffect(()=>{var i;if(!((i=e==null?void 0:e.tokenLogin)!=null&&i.loginToken)||!t.address){g.setHeader("Authorization",void 0);return}(async()=>{if(sessionStorage.getItem(`authToken${t.address}${e.tokenLogin.loginToken}`)){let o=sessionStorage.getItem(`authToken${t.address}${e.tokenLogin.loginToken}`);g.setHeader("Authorization","Bearer "+o)}else{const o=p.gql`
                    mutation($address: String!, $signature: String!, $token: String) {
                        verifyLogin(address: $address, signature: $signature, token: $token) {
                            success
                            token
                        }
                    }
                `,s=await g.request(o,{address:t.address,signature:e.tokenLogin.signature,token:e.tokenLogin.loginToken});s.verifyLogin.success&&(g.setHeader("Authorization","Bearer "+s.verifyLogin.token),sessionStorage.setItem(`authToken${t.address}${e.tokenLogin.loginToken}`,s.verifyLogin.token))}})()},[(l=e==null?void 0:e.tokenLogin)==null?void 0:l.loginToken,t.address]),m.useEffect(()=>{let i=a.signedTransactionsArray.filter(o=>o[1].status==="signed");for(const o of i){const[s,u]=o;for(let c of u.transactions){const w=c;c=new q.Transaction(c);let h=q.TransactionPayload.fromEncoded(c.getData()).getEncodedArguments();h.length>0&&h[0]==="signComment"&&setTimeout(()=>{r(b({transactionHash:w.hash,sessionId:s,status:j.success})),r(v({sessionId:s,status:H.success}))},1e3)}}},[a]),null},X=async()=>{let a=document.querySelectorAll("[data-web3-space]");if(a.length===0)return;const r=Array.from(a),e=document.getElementsByClassName("dapp-required")[0];let t=document.createElement("div");t.setAttribute("id","app"),e.appendChild(t),N(t).render(L(J,{allAds:r,children:[d(P,{className:"transactions-toast-list",transactionToastClassName:"transactions-toast-class",successfulToastLifetime:3e4}),d(B,{}),d(G,{}),d(V,{})]}))};X();export{ee as F,g as G,O as _,L as a,te as b,se as c,d as j,U as s,ne as t};
