import{j as k,R as I,b as $,G as A,r as R,c as g,d as f,e as w,g as _,f as x,h as C,m as b,i as j,o as S,k as v,l as N,J as P,I as G,n as H,p as W,H as B,q as D}from"./vendor-271676b3.js";import"./lodash-87d1c6bb.js";import"./bignumber-d824444f.js";const se=k.Fragment,c=k.jsx,E=k.jsxs,O="modulepreload",F=function(r){return"/wp-content/themes/pacurar2020/public/"+r},T={},M=function(i,e,n){if(!e||e.length===0)return i();const u=document.getElementsByTagName("link");return Promise.all(e.map(o=>{if(o=F(o),o in T)return;T[o]=!0;const l=o.endsWith(".css"),p=l?'[rel="stylesheet"]':"";if(!!n)for(let t=u.length-1;t>=0;t--){const a=u[t];if(a.href===o&&(!l||a.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${p}`))return;const s=document.createElement("link");if(s.rel=l?"stylesheet":O,l||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),l)return new Promise((t,a)=>{s.addEventListener("load",t),s.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>i())},z="mainnet",J="6849db0c57e4bf778ed8bdd2d721ee4f",ne="erd1qqqqqqqqqqqqqpgqq72p4p73sx6wkurl3epefzt4dkvwh7frvp3s73l9k6",oe="erd158lk5s2m3cpjyg5fwgm0pwnt8ugnc29mj4nafkrvcrhfdfpgvp3swpmnrj",U=I.lazy(()=>M(()=>import("./MainAdSpaceApp-22e8feba.js"),["assets/MainAdSpaceApp-22e8feba.js","assets/vendor-271676b3.js","assets/bignumber-d824444f.js","assets/lodash-87d1c6bb.js"])),V=({children:r,allAds:i})=>c($,{children:E(A,{environment:z,customNetworkConfig:{walletConnectV2ProjectId:J},dappConfig:{logoutRoute:window.location.href},children:[r,i.map(e=>{const n=e.innerHTML;return e.innerHTML="",R.createPortal(c(g.Suspense,{fallback:c("div",{}),children:c(U,{name:e.dataset.spaceName,language:e.dataset.language,format:e.dataset.format,sidebar:e.dataset.sidebar==1,info:e.dataset.initialInfo?JSON.parse(e.dataset.initialInfo):{},session:e.dataset.sessionId,html:n})}),e)})]})}),m=new f.GraphQLClient("/gql");m.setHeader("X-Requested-With","XMLHttpRequest");const X=w({key:"session",default:""}),ae=w({key:"tempAd",default:{_title:""}}),K=()=>{var h;const r=_(),i=x(),e=C(),n=b(),[u,o]=j(X),l=()=>{for(let s=0;s<sessionStorage.length;s++){let t=sessionStorage.key(s);t!=null&&t.startsWith("authToken")&&sessionStorage.removeItem(t)}},p=()=>{for(let s=0;s<sessionStorage.length;s++){let t=sessionStorage.key(s);if(t!=null&&t.startsWith("authToken"))return!0}return!1};return g.useEffect(()=>{let s=document.querySelector("[data-web3-space]");if(s){o(s.dataset.sessionId);return}m.request(f.gql`
            { sessionInfo { id } }
        `).then(t=>{o(t.sessionInfo.id)})},[]),g.useEffect(()=>{var t;if(!((t=e==null?void 0:e.tokenLogin)!=null&&t.loginToken)||!n.address){const a=f.gql`
                mutation {
                    logout
                }
            `;p()&&(m.request(a),l());return}const s=sessionStorage.getItem(`authToken${n.address}${e.tokenLogin.loginToken}`);(async()=>{if(!s){const a=f.gql`
                    mutation($address: String!, $signature: String!, $token: String) {
                        verifyLogin(address: $address, signature: $signature, token: $token) {
                            success
                            # token
                        }
                    }
                `;if((await m.request(a,{address:n.address,signature:e.tokenLogin.signature,token:e.tokenLogin.loginToken})).verifyLogin.success){const d="1";sessionStorage.setItem(`authToken${n.address}${e.tokenLogin.loginToken}`,d)}}})()},[(h=e==null?void 0:e.tokenLogin)==null?void 0:h.loginToken,n.address]),g.useEffect(()=>{let s=r.signedTransactionsArray.filter(t=>t[1].status==="signed");for(const t of s){const[a,q]=t;for(let d of q.transactions){const L=d;d=new S.Transaction(d);let y=S.TransactionPayload.fromEncoded(d.getData()).getEncodedArguments();y.length>0&&y[0]==="signComment"&&setTimeout(()=>{i(v({transactionHash:L.hash,sessionId:a,status:N.success})),i(P({sessionId:a,status:G.success}))},1e3)}}},[r]),null},Q=async()=>{let r=document.querySelectorAll("[data-web3-space]");if(r.length===0)return;const i=Array.from(r),e=document.getElementsByClassName("dapp-required")[0];let n=document.createElement("div");n.setAttribute("id","app"),e.appendChild(n),H(n).render(E(V,{allAds:i,children:[c(W,{className:"transactions-toast-list",transactionToastClassName:"transactions-toast-class",successfulToastLifetime:3e4}),c(B,{}),c(D,{}),c(K,{})]}))};Q();export{se as F,m as G,M as _,E as a,ne as b,oe as c,c as j,X as s,ae as t};
