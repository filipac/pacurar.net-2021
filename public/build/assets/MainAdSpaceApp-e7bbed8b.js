import{s as ae,t as re,G as ne,c as R,j as t,a as i,F as a,u as ie,b as f}from"./react-app-aae81626.js";import{i as S,m as oe,b as W,r as o,v as le,w as de,e as ce,G as he,c as l,J as me,U as ue,H as xe,C as be,x as P,o as h,h as U}from"./vendor-9741ff7b.js";import"./lodash-0223fb8a.js";import"./bignumber-63705fc6.js";const q=S.lazy(()=>import("./BuySpace-ddc41df6.js")),we=S.lazy(()=>import("./SpaceEdit-4cd12e2c.js")),ge=({name:b="",language:n,html:w,format:C,sidebar:d,info:V,session:pe})=>{const s=oe(),[p,ye]=W(ae),[e,F]=o.useState(V),[L,u]=o.useState(!1),[y,_]=o.useState(!1),[G,X]=o.useState(!0),[g]=W(re),M=(g==null?void 0:g[b])||"",[E,k]=o.useState(""),[N,A]=o.useState(null);o.useEffect(()=>{k(w||"")},[w]);const $=async()=>{console.log(await(async()=>{await U({transactions:[{value:"0",data:"withdraw",receiver:f,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Au intrat banutii":"Money is in your wallet",transactionDuration:1e4}})})())},{successfulTransactionsArray:z}=le(),{pendingTransactionsArray:j}=de(),Y=r=>{if(!r[1].transactions)return!1;const m=h.Transaction.fromPlainObject(r[1].transactions[0]);if(m.getReceiver().bech32()===f){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===2&&c[0]==="resetSpace"&&c[1]===new h.ArgSerializer().valuesToString([new h.StringValue(e.name)]).argumentsString)return!0}return!1},J=r=>{if(!r[1].transactions)return!1;const m=h.Transaction.fromPlainObject(r[1].transactions[0]);if(m.getReceiver().bech32()===f){let c=h.TransactionPayload.fromEncoded(m.getData().encoded()).getEncodedArguments();if(c.length===1&&c[0]==="withdraw")return!0}return!1},O=o.useMemo(()=>z.some(Y),[z]),H=o.useMemo(()=>j.some(J),[j]);o.useEffect(()=>{O&&D(e.name)},[O]);const K=async r=>{if(!r||r.length===0)return;console.log(await(async()=>{const v=new h.ArgSerializer;let c="resetSpace";c+="@"+v.valuesToString([new h.StringValue(r)]).argumentsString,await U({transactions:[{value:"0",data:c,receiver:f,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:n=="ro"?"Asteptam...":"Waiting...",successMessage:n=="ro"?"Spatiul a fost resetat":"Space was reset",transactionDuration:1e4}})})())},D=async r=>{const v=(await ne.request(ce.gql`
            query adSpaceInfo($spaceName: String!, $initial: Boolean) {
                adSpaceInfo(spaceName: $spaceName, initial: $initial) {
                    name
                    is_new
                    owner
                    paid_amount
                    paid_until
                }
            }
        `,{spaceName:r,initial:G})).adSpaceInfo;F(v)};o.useEffect(()=>{(async()=>e!=null&&e.name||(await D(b),X(!0)))()},[b]);const T=o.useCallback(()=>{D(b)},[b]),Q=[(s==null?void 0:s.address)==R&&t("div",{style:{flexBasis:"100%",height:0}},"emtpty-div"),(s==null?void 0:s.address)==R&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),$()},children:[!H&&i(a,{children:[n=="en"&&t(a,{children:"Withdraw"}),n=="ro"&&t(a,{children:"Retrage banii"})]}),H&&t(a,{children:"..."})]},"withdraw-btn"),s.address&&s.address==R&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-red-500 text-white shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),K((e==null?void 0:e.name)||"")},children:[n=="en"&&t(a,{children:"Reset space"}),n=="ro"&&t(a,{children:"Reseteaza spatiul"})]},"reset-btn")],B=[s.address&&s.address!=(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),u(!0)},children:[n=="en"&&t(a,{children:"Replace with your advertisement"}),n=="ro"&&t(a,{children:"Inlocuieste cu reclama ta"})]},"replace-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&!y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),_(!0)},children:[n=="en"&&t(a,{children:"Edit space"}),n=="ro"&&t(a,{children:"Editeaza spatiul"})]},"edit-btn"),s.address&&s.address==(e==null?void 0:e.owner)&&!(e!=null&&e.is_new)&&y&&i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),_(!1)},children:[n=="en"&&t(a,{children:"Cancel edit"}),n=="ro"&&t(a,{children:"Anuleaza editarea"})]},"cancel-btn"),i("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:r=>{r.preventDefault(),he()},children:[n=="en"&&t(a,{children:"Logout"}),n=="ro"&&t(a,{children:"Logout"})]},"logout-btn"),...Q].filter(Boolean),{showLogin:x,setShowLogin:Z,loginActions:I}=ie({sessionId:p});o.useEffect(()=>{s!=null&&s.address&&x&&A(null)},[x,s]),o.useEffect(()=>{s!=null&&s.address&&N&&N=="outbid"&&(e.owner&&e.owner!=s.address&&u(!0),A(null))},[N,s==null?void 0:s.address,e]);const ee=[!(e!=null&&e.is_new)&&i("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__m-1 text-xs p-2 mx-0 bg-yellow-500 shadow-box hover:shadow-boxhvr text-black",onClick:r=>{r.preventDefault(),s!=null&&s.address?u(!0):(Z(!x),A(x?null:"outbid"))},children:[x&&i(a,{children:[n=="en"&&t(a,{children:"Cancel outbid"}),n=="ro"&&t(a,{children:"Renunta"})]}),!x&&i(a,{children:[n=="en"&&t(a,{children:"Replace with your advertisement"}),n=="ro"&&t(a,{children:"Inlocuieste cu reclama ta"})]})]},"login-btn"),...I].filter(Boolean);if(!(e!=null&&e.name)&&w&&w.length>1)return t(a,{children:t("div",{className:l("bg-primary py-4 px-4",{}),children:e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?M:E}})})});if(e!=null&&e.is_new)return t("div",{className:l("py-4 px-4",{"bg-primary":C=="light","bg-splash text-white":C=="dark"}),children:i("div",{className:"flex flex-col items-center justify-center",children:[(!s.address||s.address&&e.owner!=s.address)&&i(a,{children:[n=="ro"&&i(a,{children:[t("div",{className:l("font-bold text-center",{"text-2xl":!d,"mb-4":d}),children:"Acest spatiu publicitar poate fi tau pentru 10 de zile."}),i("p",{className:l("text-center",{"mb-4":d}),children:["Costa doar ",e==null?void 0:e.paid_amount," USDC/USDT / 10 zile.",t("br",{}),"Il inchiriezi instant cu ajutorul blockchain-ului MultiversX si il poti personaliza cum vrei tu."]})]}),n=="en"&&i(a,{children:[t("div",{className:l("font-bold",{"text-2xl":!d,"mb-4":d}),children:"This ad space can be yours for 10 days."}),i("p",{className:l("text-center",{"mb-4":d}),children:["It costs only ",e==null?void 0:e.paid_amount," USDC/USDT per 10 days.",t("br",{})," You rent it instantly using the MultiversX blockchain and you can customize it as you want."]})]})]}),!s.address&&t(a,{children:i("div",{className:l("flex mt-2 flex-col items-center md:flex-row",{"flex flex-col md:flex-col gap-2":d}),children:[t(me,{isWalletConnectV2:!0,token:p,logoutRoute:window.location.href,className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",showScamPhishingAlert:!0}),t(ue,{token:p,showScamPhishingAlert:!0,className:"text-xs p-2 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black  border-secondary"}),t(xe,{className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",token:p,loginButtonText:"MultiversX DeFi Wallet"}),t(be,{token:p,callbackRoute:window.location.pathname,className:"text-xs p-2 mx-0 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",onLoginRedirect:{callbackRoute:window.location.pathname},nativeAuth:!0})]})}),s.address&&e.owner!=s.address&&t(a,{children:t("div",{className:l("mt-2",{"mt-4":d}),children:i("button",{className:"p-2 bg-secondary text-black shadow-box hover:shadow-boxhvr text-xs",onClick:r=>{r.preventDefault(),u(!0)},children:[n=="ro"&&t(a,{children:"Inchiriaza acest spatiu"}),n=="en"&&t(a,{children:"Rent this space"})]})})}),s.address&&t(a,{children:t("div",{className:l("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":d}),style:{width:"fit-content"},children:B})}),t(S.Suspense,{fallback:t("div",{}),children:t(q,{open:L,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})});const te=e!=null&&e.paid_until?P(new Date((e==null?void 0:e.paid_until)*1e3),"dd.MM.yyyy HH:mm"):"",se=e!=null&&e.paid_until?P(new Date((e==null?void 0:e.paid_until)*1e3),"MM-dd-yyyy HH:mm a"):"";return i(a,{children:[i("div",{className:l("bg-primary py-4 px-4",{}),children:[(s==null?void 0:s.address)&&(e==null?void 0:e.owner)==s.address&&t(a,{children:i("div",{className:l("font-bold text-xs bg-secondary py-2 px-4 rounded-2xl max-w border border-black mb-2"),style:{maxWidth:"fit-content"},children:[n=="ro"&&i(a,{children:["Deti acest spatiu pana in ",te]}),n=="en"&&i(a,{children:["You own this space until ",se]})]})}),e&&!(e!=null&&e.is_new)&&t("div",{className:"space__content",dangerouslySetInnerHTML:{__html:y?M:E}}),y&&t(a,{children:t(o.Suspense,{fallback:t("div",{children:"Loading"}),children:t(we,{spaceInfo:e,close:()=>{_(!1)},sidebar:d,language:n,refreshSpace:r=>{T(),k(r)}})})}),e.name&&i(a,{children:[s.address&&t("div",{className:l("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":d}),style:{width:"fit-content"},children:B}),!(s!=null&&s.address)&&t("div",{className:l("mt-3 self-end flex gap-2 justify-end",{"flex-col mt-4":d}),children:ee})]})]}),t(S.Suspense,{fallback:t("div",{}),children:t(q,{open:L,setOpen:u,spaceInfo:e,language:n,refreshSpace:T})})]})};export{ge as default};
