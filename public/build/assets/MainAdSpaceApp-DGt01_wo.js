import{p as ie,b as B,u as oe,r as n,z as de,w as le,y as ce,d as xe,j as e,Z as me,c as i,F as he,q as ue,Y as be,v as pe,f as y,A as H,o as x,_ as q,k as W}from"./vendor-DZp4qUgB.js";import"./bignumber-L0kgG1Q3.js";import"./lodash-C-76dkfd.js";import{s as we,t as je,G as ge,c as A,u as ye,a as g}from"./react-app-DjWCPCj7.js";const $=y.lazy(()=>q(()=>import("./BuySpace-OZ-u7ISW.js"),[])),ve=y.lazy(()=>q(()=>import("./SpaceEdit-B10wh_pe.js"),[])),Ae=({name:b="",language:r,html:p,format:D,sidebar:o,info:V,session:fe})=>{var P;const s=ie(),[m,_e]=B(we),j=oe(),[t,Y]=n.useState(V),[U,X]=n.useState(null);n.useEffect(()=>{let a=j.configuration;a.extraInfo={sessionId:m},de(a).initialize().then(c=>{X(c),document.cookie=`login_token=${c};path=/;max-age=3600`})},[(P=j==null?void 0:j.configuration)==null?void 0:P.apiAddress,m]);const[E,h]=n.useState(!1),[w,v]=n.useState(!1),[G,Z]=n.useState(!0),[f]=B(je),T=(f==null?void 0:f[b])||"",[R,_]=n.useState(""),[S,k]=n.useState(null);n.useEffect(()=>{_(p||"")},[p]);const J=async()=>{console.log(await(async()=>{await W({transactions:[{value:"0",data:"withdraw",receiver:g,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:r=="ro"?"Asteptam...":"Waiting...",successMessage:r=="ro"?"Au intrat banutii":"Money is in your wallet",transactionDuration:1e4}})})())},{successfulTransactionsArray:L}=le(),{pendingTransactionsArray:M}=ce(),K=a=>{if(!a[1].transactions)return!1;const l=x.Transaction.fromPlainObject(a[1].transactions[0]);if(l.getReceiver().bech32()===g){let d=x.TransactionPayload.fromEncoded(l.getData().encoded()).getEncodedArguments();if(d.length===2&&d[0]==="resetSpace"&&d[1]===new x.ArgSerializer().valuesToString([new x.StringValue(t.name)]).argumentsString)return!0}return!1},Q=a=>{if(!a[1].transactions)return!1;const l=x.Transaction.fromPlainObject(a[1].transactions[0]);if(l.getReceiver().bech32()===g){let d=x.TransactionPayload.fromEncoded(l.getData().encoded()).getEncodedArguments();if(d.length===1&&d[0]==="withdraw")return!0}return!1},z=n.useMemo(()=>L.some(K),[L]),C=n.useMemo(()=>M.some(Q),[M]);n.useEffect(()=>{z&&F(t.name)},[z]);const I=async a=>{if(!a||a.length===0)return;console.log(await(async()=>{const c=new x.ArgSerializer;let d="resetSpace";d+="@"+c.valuesToString([new x.StringValue(a)]).argumentsString,await W({transactions:[{value:"0",data:d,receiver:g,gasLimit:"40000000"}],transactionsDisplayInfo:{processingMessage:r=="ro"?"Asteptam...":"Waiting...",successMessage:r=="ro"?"Spatiul a fost resetat":"Space was reset",transactionDuration:1e4}})})())},F=async a=>{const c=(await ge.request(xe.gql`
            query adSpaceInfo($spaceName: String!, $initial: Boolean) {
                adSpaceInfo(spaceName: $spaceName, initial: $initial) {
                    name
                    is_new
                    owner
                    paid_amount
                    paid_until
                }
            }
        `,{spaceName:a,initial:G})).adSpaceInfo;Y(c)};n.useEffect(()=>{(async()=>t!=null&&t.name||(await F(b),Z(!0)))()},[b]);const N=n.useCallback(()=>{F(b)},[b]),ee=[(s==null?void 0:s.address)==A&&e.jsx("div",{style:{flexBasis:"100%",height:0}},"emtpty-div"),(s==null?void 0:s.address)==A&&e.jsxs("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),J()},children:[!C&&e.jsxs(e.Fragment,{children:[r=="en"&&e.jsx(e.Fragment,{children:"Withdraw"}),r=="ro"&&e.jsx(e.Fragment,{children:"Retrage banii"})]}),C&&e.jsx(e.Fragment,{children:"..."})]},"withdraw-btn"),s.address&&s.address==A&&!(t!=null&&t.is_new)&&e.jsxs("button",{className:"p-2 bg-red-500 text-white shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),I((t==null?void 0:t.name)||"")},children:[r=="en"&&e.jsx(e.Fragment,{children:"Reset space"}),r=="ro"&&e.jsx(e.Fragment,{children:"Reseteaza spatiul"})]},"reset-btn")],O=[s.address&&s.address!=(t==null?void 0:t.owner)&&!(t!=null&&t.is_new)&&e.jsxs("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),h(!0)},children:[r=="en"&&e.jsx(e.Fragment,{children:"Replace with your advertisement"}),r=="ro"&&e.jsx(e.Fragment,{children:"Inlocuieste cu reclama ta"})]},"replace-btn"),s.address&&s.address==(t==null?void 0:t.owner)&&!(t!=null&&t.is_new)&&!w&&e.jsxs("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),v(!0)},children:[r=="en"&&e.jsx(e.Fragment,{children:"Edit space"}),r=="ro"&&e.jsx(e.Fragment,{children:"Editeaza spatiul"})]},"edit-btn"),s.address&&s.address==(t==null?void 0:t.owner)&&!(t!=null&&t.is_new)&&w&&e.jsxs("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),v(!1)},children:[r=="en"&&e.jsx(e.Fragment,{children:"Cancel edit"}),r=="ro"&&e.jsx(e.Fragment,{children:"Anuleaza editarea"})]},"cancel-btn"),e.jsxs("button",{className:"p-2 bg-secondary shadow-box hover:shadow-boxhvr text-xs text-black",onClick:a=>{a.preventDefault(),me()},children:[r=="en"&&e.jsx(e.Fragment,{children:"Logout"}),r=="ro"&&e.jsx(e.Fragment,{children:"Logout"})]},"logout-btn"),...ee].filter(Boolean),{showLogin:u,setShowLogin:te,loginActions:se}=ye({sessionId:m});n.useEffect(()=>{s!=null&&s.address&&u&&k(null)},[u,s]),n.useEffect(()=>{s!=null&&s.address&&S&&S=="outbid"&&(t.owner&&t.owner!=s.address&&h(!0),k(null))},[S,s==null?void 0:s.address,t]);const ae=[!(t!=null&&t.is_new)&&e.jsxs("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__m-1 text-xs p-2 mx-0 bg-yellow-500 shadow-box hover:shadow-boxhvr text-black",onClick:a=>{a.preventDefault(),s!=null&&s.address?h(!0):(te(!u),k(u?null:"outbid"))},children:[u&&e.jsxs(e.Fragment,{children:[r=="en"&&e.jsx(e.Fragment,{children:"Cancel outbid"}),r=="ro"&&e.jsx(e.Fragment,{children:"Renunta"})]}),!u&&e.jsxs(e.Fragment,{children:[r=="en"&&e.jsx(e.Fragment,{children:"Replace with your advertisement"}),r=="ro"&&e.jsx(e.Fragment,{children:"Inlocuieste cu reclama ta"})]})]},"login-btn"),...se].filter(Boolean);if(!(t!=null&&t.owner)&&p&&p.length>1)return e.jsx(e.Fragment,{children:e.jsx("div",{className:i("bg-primary py-4 px-4",{}),children:t&&!(t!=null&&t.is_new)&&e.jsx("div",{className:"space__content",dangerouslySetInnerHTML:{__html:w?T:R}})})});if(t!=null&&t.is_new)return e.jsx("div",{className:i("py-4 px-4",{"bg-primary":D=="light","bg-splash text-white":D=="dark"}),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[(!s.address||s.address&&t.owner!=s.address)&&e.jsxs(e.Fragment,{children:[r=="ro"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:i("font-bold text-center",{"text-2xl":!o,"mb-4":o}),children:"Acest spatiu publicitar poate fi tau pentru 10 de zile."}),e.jsxs("p",{className:i("text-center",{"mb-4":o}),children:["Costa doar ",t==null?void 0:t.paid_amount," USDC/USDT / 10 zile.",e.jsx("br",{}),"Il inchiriezi instant cu ajutorul blockchain-ului MultiversX si il poti personaliza cum vrei tu."]})]}),r=="en"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:i("font-bold",{"text-2xl":!o,"mb-4":o}),children:"This ad space can be yours for 10 days."}),e.jsxs("p",{className:i("text-center",{"mb-4":o}),children:["It costs only ",t==null?void 0:t.paid_amount," USDC/USDT per 10 days.",e.jsx("br",{})," You rent it instantly using the MultiversX blockchain and you can customize it as you want."]})]})]}),!s.address&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:i("flex mt-2 flex-col items-center md:flex-row",{"flex flex-col md:flex-col gap-2":o}),children:[e.jsx(he,{nativeAuth:!0,token:m,logoutRoute:window.location.href,className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary"}),e.jsx(ue,{token:m,showScamPhishingAlert:!0,className:"text-xs p-2 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black  border-secondary"}),e.jsx(be,{className:"text-xs p-2 mx-0 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary",token:m,loginButtonText:"MultiversX DeFi Wallet"}),e.jsx(pe,{token:U,callbackRoute:window.location.pathname,className:"text-xs p-2 mx-0 ml-4 bg-secondary shadow-box hover:shadow-boxhvr text-black border-secondary"})]})}),s.address&&t.owner!=s.address&&e.jsx(e.Fragment,{children:e.jsx("div",{className:i("mt-2",{"mt-4":o}),children:e.jsxs("button",{className:"p-2 bg-secondary text-black shadow-box hover:shadow-boxhvr text-xs",onClick:a=>{a.preventDefault(),h(!0)},children:[r=="ro"&&e.jsx(e.Fragment,{children:"Inchiriaza acest spatiu"}),r=="en"&&e.jsx(e.Fragment,{children:"Rent this space"})]})})}),s.address&&e.jsx(e.Fragment,{children:e.jsx("div",{className:i("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":o}),style:{width:"fit-content"},children:O})}),e.jsx(y.Suspense,{fallback:e.jsx("div",{}),children:e.jsx($,{open:E,setOpen:h,spaceInfo:t,language:r,refreshSpace:N})})]})});const re=t!=null&&t.paid_until?H(new Date((t==null?void 0:t.paid_until)*1e3),"dd.MM.yyyy HH:mm"):"",ne=t!=null&&t.paid_until?H(new Date((t==null?void 0:t.paid_until)*1e3),"MM-dd-yyyy HH:mm a"):"";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:i("bg-primary py-4 px-4",{}),children:[(s==null?void 0:s.address)&&(t==null?void 0:t.owner)==s.address&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:i("font-bold text-xs bg-secondary py-2 px-4 rounded-2xl max-w border border-black mb-2"),style:{maxWidth:"fit-content"},children:[r=="ro"&&e.jsxs(e.Fragment,{children:["Deti acest spatiu pana in ",re]}),r=="en"&&e.jsxs(e.Fragment,{children:["You own this space until ",ne]})]})}),t&&!(t!=null&&t.is_new)&&e.jsx("div",{className:"space__content",dangerouslySetInnerHTML:{__html:w?T:R}}),w&&e.jsx(e.Fragment,{children:e.jsx(n.Suspense,{fallback:e.jsx("div",{children:"Loading"}),children:e.jsx(ve,{spaceInfo:t,close:()=>{v(!1)},sidebar:o,language:r,refreshSpace:a=>{N(),_(a)}})})}),t.name&&e.jsxs(e.Fragment,{children:[s.address&&e.jsx("div",{className:i("mt-3 flex flex-wrap self-end justify-end gap-2 ml-auto",{"mt-4 transform scale-75 origin-right":o}),style:{width:"fit-content"},children:O}),!(s!=null&&s.address)&&e.jsx("div",{className:i("mt-3 self-end flex gap-2 justify-end",{"flex-col mt-4":o}),children:ae})]})]}),e.jsx(y.Suspense,{fallback:e.jsx("div",{}),children:e.jsx($,{open:E,setOpen:h,spaceInfo:t,language:r,refreshSpace:N})})]})};export{Ae as default};
